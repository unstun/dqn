{
  "_meta": {
    "title": "forest_a CNN-DDQN strict no-fallback v3p12 smoke c",
    "date": "2026-02-09",
    "summary": "v3p12 base for new train-progress metrics + RL early-stop + throughput fuse, strict no-fallback pure argmax inference.",
    "source_profile": "repro_20260209_forest_a_cnn_ddqn_strict_no_fallback_v3p11_smoke",
    "commands": [
      "conda run -n ros2py310 python train.py --profile repro_20260209_forest_a_cnn_ddqn_strict_no_fallback_v3p12_smoke_c",
      "conda run -n ros2py310 python infer.py --profile repro_20260209_forest_a_cnn_ddqn_strict_no_fallback_v3p12_smoke_c"
    ],
    "notes": [
      "Strict no-fallback: inference action is pure argmax(Q), no masking/replacement/top-k/stop-override/fallback.",
      "Train-progress metrics every 10 episodes on fixed short/long suites (SR and distance_ratio).",
      "RL early-stop enabled after warmup using sr_all + distance_ratio plateau criterion.",
      "Throughput fuse aborts low-episode but long-wallclock abnormal runs."
    ]
  },
  "train": {
    "envs": [
      "forest_a"
    ],
    "out": "repro_20260209_forest_a_cnn_ddqn_strict_no_fallback_v3p12_smoke_c",
    "rl_algos": [
      "cnn-ddqn"
    ],
    "demo_mode": "dqfd",
    "episodes": 120,
    "max_steps": 1200,
    "gamma": 0.997,
    "learning_rate": 0.0001,
    "batch_size": 128,
    "target_update_steps": 2000,
    "target_update_tau": 0.0,
    "grad_clip_norm": 10.0,
    "eps_start": 0.2,
    "eps_final": 0.02,
    "eps_decay": 4500,
    "hidden_layers": 3,
    "hidden_dim": 256,
    "dqfd_n_step": 10,
    "dqfd_lambda_n": 0.5,
    "dqfd_l2": 1e-05,
    "per_alpha": 0.4,
    "per_beta0": 0.6,
    "per_beta_steps": 0,
    "per_eps_agent": 0.001,
    "per_eps_demo": 3.0,
    "demo_lambda": 8.0,
    "demo_margin": 2.0,
    "forest_expert": "hybrid_astar_mpc",
    "forest_astar_opt_enable": false,
    "forest_astar_timeout": 5.0,
    "forest_astar_max_expanded": 1000000,
    "forest_mpc_horizon_steps": 12,
    "forest_mpc_candidates": 256,
    "forest_mpc_dt_s": 0.0,
    "forest_mpc_w_u": 0.05,
    "forest_mpc_w_du": 0.5,
    "forest_mpc_w_pos": 6.0,
    "forest_mpc_w_yaw": 1.2,
    "forest_mpc_align_dist_m": 1.5,
    "forest_mpc_collision_padding_m": 0.0,
    "forest_mpc_goal_lookahead_steps": 2,
    "forest_random_start_goal": true,
    "forest_curriculum": true,
    "forest_rand_min_dist_m": 6.0,
    "forest_rand_max_dist_m": 0.0,
    "forest_rand_edge_margin_m": 3.0,
    "forest_rand_fixed_prob": 0.1,
    "forest_rand_tries": 200,
    "forest_train_two_suites": true,
    "forest_train_short_prob": 0.55,
    "forest_train_short_prob_ramp": 0.2,
    "forest_train_short_min_dist_m": 6.0,
    "forest_train_short_max_dist_m": 14.0,
    "forest_train_long_min_dist_m": 42.0,
    "forest_train_long_max_dist_m": 0.0,
    "forest_demo_prefill": true,
    "forest_demo_pretrain_steps": 30000,
    "forest_expert_exploration": false,
    "forest_action_shield": false,
    "forest_no_fallback": true,
    "forest_adm_horizon": 20,
    "forest_action_delta_dot_bins": 15,
    "forest_action_accel_bins": 15,
    "goal_tolerance_m": 1.0,
    "goal_angle_tolerance_deg": 180.0,
    "goal_stop_speed_m_s": 0.1,
    "goal_stop_delta_deg": 3.0,
    "learning_starts": 500,
    "save_ckpt": "auto",
    "save_ckpt_joint_short_long": true,
    "save_ckpt_suite_runs": 10,
    "save_ckpt_short_min_dist_m": 6.0,
    "save_ckpt_short_max_dist_m": 14.0,
    "save_ckpt_long_min_dist_m": 42.0,
    "save_ckpt_long_max_dist_m": 0.0,
    "device": "cuda",
    "cuda_device": 0,
    "seed": 21,
    "progress": true,
    "forest_demo_horizon": 3,
    "forest_goal_admissible_relax_factor": 2.5,
    "forest_reward_no_progress_penalty": 0.35,
    "forest_reward_no_progress_eps_m": 0.03,
    "forest_reward_idle_speed_m_s": 0.12,
    "forest_demo_filter_min_progress_ratio": 0.05,
    "forest_demo_filter_min_progress_per_step_m": 0.0,
    "forest_demo_filter_max_steps": 0,
    "forest_min_progress_m": -0.02,
    "forest_demo_pretrain_early_stop_sr": 0.5,
    "forest_demo_pretrain_early_stop_patience": 1,
    "train_eval_every": 10,
    "train_eval_short_min_dist_m": 6.0,
    "train_eval_short_max_dist_m": 14.0,
    "train_eval_long_min_dist_m": 42.0,
    "train_eval_long_max_dist_m": 0.0,
    "train_eval_seed_base": 131071,
    "train_eval_astar_timeout": 5.0,
    "train_eval_astar_max_expanded": 1000000,
    "rl_early_stop_warmup_episodes": 80,
    "rl_early_stop_patience_points": 6,
    "rl_early_stop_min_delta_sr": 0.01,
    "rl_early_stop_min_delta_ratio": 0.01,
    "throughput_abort_min_episodes": 50,
    "throughput_abort_max_minutes": 90.0
  },
  "infer": {
    "envs": [
      "forest_a"
    ],
    "models": "repro_20260209_forest_a_cnn_ddqn_strict_no_fallback_v3p12_smoke_c",
    "out": "repro_20260209_forest_a_cnn_ddqn_strict_no_fallback_v3p12_smoke_c",
    "rl_algos": [
      "cnn-ddqn"
    ],
    "baselines": [
      "hybrid_astar_mpc"
    ],
    "forest_astar_opt_enable": false,
    "forest_mpc_horizon_steps": 12,
    "forest_mpc_candidates": 256,
    "forest_mpc_dt_s": 0.0,
    "forest_mpc_w_u": 0.05,
    "forest_mpc_w_du": 0.5,
    "forest_mpc_w_pos": 6.0,
    "forest_mpc_w_yaw": 1.2,
    "forest_mpc_align_dist_m": 1.5,
    "forest_mpc_collision_padding_m": 0.0,
    "forest_mpc_goal_lookahead_steps": 2,
    "baseline_timeout": 60.0,
    "random_start_goal": true,
    "rand_two_suites": true,
    "runs": 10,
    "progress": true,
    "forest_no_fallback": true,
    "forest_adm_horizon": 20,
    "forest_action_delta_dot_bins": 15,
    "forest_action_accel_bins": 15,
    "rand_short_min_dist_m": 6.0,
    "rand_short_max_dist_m": 14.0,
    "rand_long_min_dist_m": 42.0,
    "rand_long_max_dist_m": 0.0,
    "rand_edge_margin_m": 3.0,
    "rand_reject_unreachable": true,
    "rand_reject_policy": "none",
    "rand_tries": 400,
    "max_steps": 1200,
    "no_terminate_on_stuck": true,
    "goal_tolerance_m": 1.0,
    "goal_angle_tolerance_deg": 180.0,
    "goal_stop_speed_m_s": 0.1,
    "goal_stop_delta_deg": 3.0,
    "kpi_time_mode": "policy",
    "device": "auto",
    "cuda_device": 0,
    "seed": 43,
    "forest_goal_admissible_relax_factor": 2.5,
    "forest_min_progress_m": -0.02
  }
}